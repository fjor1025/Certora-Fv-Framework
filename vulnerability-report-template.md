# [Vulnerability Class] in [Contract::function] Allows [Impact]

## Summary

[In 2-3 natural sentences, explain: What's the vulnerability? How can it be exploited? What's the impact? Write this like you're explaining to a colleague, not filling a form.]

**Quick facts:**
- **Severity:** [Critical/High/Medium/Low]
- **Location:** `contracts/[path]/Contract.sol` (line [X])
- **Attack cost:** [X ETH/tokens] | **Profit:** [Y ETH/tokens]
- **Privileges required:** [None/User/Admin]

---

## Vulnerability Details

### The Problem

[Explain the root cause in technical but natural language. Start with "The vulnerability exists because..." or "I found that..." Use paragraphs, not bullet points.]

The vulnerable code is in `[Contract.sol::function()]` at lines [X-Y]:

```solidity
function vulnerableFunction([params]) external {
    // [!] ISSUE: [One line explaining what's wrong]
    [vulnerable code snippet - 5-10 lines max]
    // Missing: [what validation/check is absent]
}
```

[Explain WHY this is vulnerable. What assumption does the code make? What does it fail to check?]

### Attack Scenario

[Write a natural narrative of how the attack works. Use "First... Then... Finally..." structure]

1. **Initial state:** [Describe preconditions naturally]
2. **Attacker action:** [What the attacker does - be specific]
3. **Vulnerable execution:** [What happens inside the contract]
4. **Result:** [What state changes occur]

The key issue is that [explain the core failure - missing check, wrong assumption, logic error].

### Why This Matters

[Explain the impact in natural language. Start broad, then get specific with numbers.]

**Direct impact:**
- [Primary consequence - e.g., "Attacker can drain X ETH from the protocol"]
- [Secondary consequence - e.g., "All users with pending withdrawals lose access"]

**Economic analysis:**
- Attacker spends: ~[X] ETH (gas + initial capital)
- Attacker gains: [Y] ETH minimum ([Z]% ROI)
- Protocol loses: [W] ETH (current TVL: [T] ETH)
- Repeatability: [Yes/No/Limited by X]

[If relevant, explain why this isn't just a "design choice" or "known limitation"]

---

## Proof of Concept

I've created a PoC that demonstrates this vulnerability on a mainnet fork. The test shows:
- Attacker starts with [X] ETH (just gas money)
- Protocol holds [Y] ETH in vulnerable contract
- After exploit: Attacker has [Z] ETH profit, protocol loses [W] ETH

### Test Code

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "forge-std/Test.sol";
import {[Contract]} from "[path]";

contract ExploitTest is Test {
    [Contract] target;
    address attacker = address(0x1337);
    
    function setUp() public {
        // Fork mainnet at recent block
        vm.createSelectFork(vm.envString("MAINNET_RPC"), [BLOCK_NUMBER]);
        
        // [Setup protocol state]
        target = [Contract]([ADDRESS]);
        
        // [Setup attacker with minimal funds]
        vm.deal(attacker, 1 ether); // Just gas money
    }
    
    function testExploit() public {
        // Record balances before
        uint256 protocolBefore = [relevant balance];
        uint256 attackerBefore = [attacker balance];
        
        // Execute attack
        vm.startPrank(attacker);
        [
            // Step-by-step exploit
            // Keep it minimal - just the key calls
        ]
        vm.stopPrank();
        
        // Verify impact
        uint256 protocolAfter = [relevant balance];
        uint256 attackerAfter = [attacker balance];
        
        uint256 protocolLoss = protocolBefore - protocolAfter;
        uint256 attackerProfit = attackerAfter - attackerBefore;
        
        console.log("Protocol lost:", protocolLoss);
        console.log("Attacker gained:", attackerProfit);
        
        // Assertions
        assertGt(protocolLoss, 0, "Protocol should lose funds");
        assertGt(attackerProfit, 0, "Attacker should profit");
    }
}
```

### Running the PoC

```bash
# Set your RPC URL
export MAINNET_RPC="[your_rpc_url]"

# Run the test
forge test --match-test testExploit -vvv

# For detailed traces
forge test --match-test testExploit -vvvv
```

**Expected output:**
```
[PASS] testExploit (gas: [X])
Logs:
  Protocol lost: [Y] ETH
  Attacker gained: [Z] ETH
```

### Key Observations

[Explain what the PoC proves - reference specific console.log outputs or assertions. Write naturally.]

The test demonstrates that [key point from PoC]. Note that [important detail that proves it's not a theoretical issue].

---

## Impact Assessment

This vulnerability allows [who] to [do what], resulting in [consequence].

**Severity justification for [Critical/High/Medium/Low]:**

[Explain in a paragraph why this deserves the severity rating. Reference specific criteria from the contest/platform if relevant. Be honest - if there are limitations or conditions, mention them.]

Key factors:
- **Fund loss:** [Yes/No] - [Direct/Indirect path to value extraction]
- **Privilege required:** [None/User/Admin] - [Explanation]
- **Attack complexity:** [Low/Medium/High] - [Why]
- **Likelihood:** [High/Medium/Low] - [Current state makes this X likely]

---

## Recommended Mitigation

[Explain the fix in natural language first, then show code]

The vulnerability can be fixed by [explanation of approach]. This prevents the exploit because [reasoning].

### Code Changes

```diff
function vulnerableFunction([params]) external {
+    // Add validation for [what]
+    require([condition], "[error message]");
+    
     // Existing code
     [...]
     
-    // Remove problematic pattern
-    [old code]
+    // Replace with secure alternative
+    [new code]
}
```

### Additional Recommendations

[If there are architectural changes or broader improvements, mention them here. Keep it practical.]

1. [Recommendation 1]
2. [Recommendation 2]
3. [Optional: Consider adding [feature] to prevent similar issues]

---

## References

[If applicable, link to:]
- Similar vulnerabilities in other protocols
- Relevant security best practices
- Documentation that contradicts the implementation

---

**Notes for reviewers:**
[Any context that helps reviewers understand edge cases, why you tested certain scenarios, or clarifications about scope. Keep this brief - 2-3 sentences max.]
